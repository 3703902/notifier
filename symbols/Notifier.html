
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="generator" content="JsDoc Toolkit" />
		<title>Notifier | JsDoc Reference</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<meta name="mobileoptimized" content="0" />
	
		<link rel="stylesheet" href="../css/all.css" media="all" />
		<link rel="stylesheet" href="../css/handheld.css" media="only screen and (max-width: 660px)" />
		<link rel="stylesheet" href="../css/handheld.css" media="handheld" />
		<link rel="stylesheet" href="../css/screen.css" media="screen and (min-width: 661px)" />

		<script src="../javascript/all.js"></script>
		<!--[if lt IE 9]>
			<script src="../javascript/html5.js"></script>
		<![endif]-->
	</head>

	<body>

<div class="index">
	<div class="menu">
		<div class="indexLinks">
			<a href="../index.html">Classes</a>
			<a href="../files.html">Files</a>
		</div>
	
		<h2 class="heading1">Classes</h2>
		
		<input type="text" name="classFilter" class="classFilter" id="ClassFilter" placeholder="Filter"></input>
		
		<nav>
			<ul class="classList" id="ClassList">
				
					<li><a href="../symbols/_global_.html">_global_</a></li>
				
					<li><a href="../symbols/APNs.html">APNs</a></li>
				
					<li><a href="../symbols/App.html">App</a></li>
				
					<li><a href="../symbols/Applications.html">Applications</a></li>
				
					<li><a href="../symbols/Config.html">Config</a></li>
				
					<li><a href="../symbols/Deque.html">Deque</a></li>
				
					<li><a href="../symbols/Deque.Node.html">Deque<span class='break'> </span>.<span class='break'> </span>Node</a></li>
				
					<li><a href="../symbols/Filters.html">Filters</a></li>
				
					<li><a href="../symbols/GCM.html">GCM</a></li>
				
					<li><a href="../symbols/LoggerUtils.html">LoggerUtils</a></li>
				
					<li><a href="../symbols/NotificationRequest.html">NotificationRequest</a></li>
				
					<li><a href="../symbols/NotificationRequestTracker.html">NotificationRequestTracker</a></li>
				
					<li><a href="../symbols/Notifier.html">Notifier</a></li>
				
					<li><a href="../symbols/PostTracker.html">PostTracker</a></li>
				
					<li><a href="../symbols/Registrar.html">Registrar</a></li>
				
					<li><a href="../symbols/RegistrationFilter.html">RegistrationFilter</a></li>
				
					<li><a href="../symbols/RegistrationStore.html">RegistrationStore</a></li>
				
					<li><a href="../symbols/TemplateCache.html">TemplateCache</a></li>
				
					<li><a href="../symbols/TemplateCache.Entry.html">TemplateCache<span class='break'> </span>.<span class='break'> </span>Entry</a></li>
				
					<li><a href="../symbols/TemplateManager.html">TemplateManager</a></li>
				
					<li><a href="../symbols/TemplateStore.html">TemplateStore</a></li>
				
					<li><a href="../symbols/WNS.html">WNS</a></li>
				
			</ul>
		</nav>
	</div>
	<div class="fineprint" style="clear:both">
		<footer>
			
			Documentation generator: <a href="http://code.google.com/p/jsdoc-toolkit/" target="_blank">JsDoc Toolkit</a> 2.4.0<br />
			Template: <a href="http://www.thebrightlines.com/2010/05/06/new-template-for-jsdoctoolkit-codeview/" target="_blank">Codeview</a> 1.2<br />
			Generated on:
			<time datetime='2014-4-14' pubdate>2014-4-14 11:36</time>
		</footer>
	</div>
</div>

<div class="index indexStatic"></div>

<div class="content">
	<div class="innerContent">
		<article>
			<header>
				<h1 class="classTitle">
					
					Class <span>Notifier</span>
				</h1>
				
				<div class="intro">
					<p class="description summary">
						A Notifier pairs notification templates to user registrations and emits those that match. One notification event can
spawn multiple actual notification deliveries depending on what registrations are present for the user and what
templates map to a notification event ID.
					</p>
						
					
						<ul class="summary">
							
							
							
								<li>Defined in: <a href="../symbols/src/notifier.js.html">notifier.js</a></li>
							
							
						</ul>
					
				</div>
			</header>
			
			
				<section>
					<div class="props">
						<table class="summaryTable" cellspacing="0" summary="A summary of the constructor documented in the class Notifier.">
							<caption class="sectionTitle">Class Summary</caption>
							<thead>
								<tr>
									<th scope="col">Constructor Attributes</th>
									<th scope="col">Constructor Name and Description</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="attributes">&nbsp;</td>
									<td class="nameDescription" >
										<div class="fixedFont">
											<b><a href="../symbols/Notifier.html#constructor">Notifier</a></b>(templateStore, registrationStore, senders, monitorManager)
										</div>
										<div class="description"><p>Notifier constructor</p></div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</section>
			
			
			
				
				<section>
					
						<nav>
							<div class="props">
								<table class="summaryTable" cellspacing="0" summary="A summary of the fields documented in the class Notifier.">
									<caption class="sectionTitle">Field Summary</caption>
									
									<thead>
										<tr>
											<th scope="col">Field Attributes</th>
											<th scope="col">Field Name and Description</th>
										</tr>
									</thead>
									
									<tbody>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#FilterModel">FilterModel</a></b>
													</div>
													<div class="description"><p>JSON schema for filter values.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#LogReceiptModel">LogReceiptModel</a></b>
													</div>
													<div class="description"><p>JSON schema for a logReceipt call.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#PostModel">PostModel</a></b>
													</div>
													<div class="description"><p>JSON schema for a notification posting request.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#postTracker">postTracker</a></b>
													</div>
													<div class="description"><p>PostTracker instance that remembers notification requests by sequenceId value.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#registrationStore">registrationStore</a></b>
													</div>
													<div class="description"><p>The backing store for registrations.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#senders">senders</a></b>
													</div>
													<div class="description"><p>Mapping of service tags ("wns", "apns", "gcm") to objects that can deliver a notification to a device.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#sequenceId">sequenceId</a></b>
													</div>
													<div class="description"><p>Sequence ID for tracking.</div>
												</td>
											</tr>
										
											<tr>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont">
													<b><a href="../symbols/Notifier.html#templateStore">templateStore</a></b>
													</div>
													<div class="description"><p>The backing store for templates.</div>
												</td>
											</tr>
										
									</tbody>
								</table>
							</div>
						</nav>
					
					
					
				</section>
			
	<!--
	#### METHODS SUMMARY
	-->
			
				<section>
					
					
					<div class="props">
						<h2 class="sectionTitle">Method Summary</h2>
						
						
							<nav>
								<table class="summaryTable" id="MethodsList" cellspacing="0" summary="A summary of the methods documented in the class Notifier.">
									<thead>
										<tr>
											<th scope="col">Method Attributes</th>
											<th scope="col">Method Name and Description</th>
										</tr>
									</thead>
									
									<tbody>
										
										
											<tr
												 class='item0'
											>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont"><b><a href="../symbols/Notifier.html#postNotification">postNotification</a></b>(req, res)
													</div>
													<div class="description"><p>Post a notification to a user.</div>
												</td>
											</tr>
										
											<tr
												 class='item1'
											>
												<td class="attributes">&nbsp;</td>
												<td class="nameDescription">
													<div class="fixedFont"><b><a href="../symbols/Notifier.html#route">route</a></b>(app)
													</div>
													<div class="description"><p>Add Express routes for the Notifier API.</div>
												</td>
											</tr>
										
									</tbody>
								</table>
							</nav>
						
					
						
					</div>
				</section>
			
			
	<!--
	#### EVENTS SUMMARY
	-->
			
	<!--
	#### CONSTRUCTOR DETAILS
	-->
			
				<section>
					<div class="details props">
						<div class="innerProps">
							<h2 class="sectionTitle" id="constructor">
								Class Detail
							</h2>
							
							<div class="fixedFont">
								<b>Notifier</b>(templateStore, registrationStore, senders, monitorManager)
							</div>
							
							<div class="description">
								<p>Notifier constructor</p>
								
							</div>
							
							
						
							
								<dl class="detailList params">
									<dt class="heading">Parameters:</dt>
									
										<dt>
											<span class="light fixedFont">{<a href="../symbols/TemplateStore.html">TemplateStore</a>}</span>  <b>templateStore</b>
											
										</dt>
										<dd><p>the repository of notification templates to rely on</p></dd>
									
										<dt>
											<span class="light fixedFont">{<a href="../symbols/RegistrationStore.html">RegistrationStore</a>}</span>  <b>registrationStore</b>
											
										</dt>
										<dd><p>the repository of user registrations to rely on</p></dd>
									
										<dt>
											<span class="light fixedFont">{Hash}</span>  <b>senders</b>
											
										</dt>
										<dd><p>a mapping of notification service tags to objects that provide a sendNotification method</p></dd>
									
										<dt>
											 <b>monitorManager</b>
											
										</dt>
										<dd></dd>
									
								</dl>
							
							
							
						</div>
					</div>
				</section>
			
	<!--
	#### FIELD DETAILS
	-->
			
				<section>
					<div class="details props">
						<div class="innerProps">
							<h2 class="sectionTitle">
								Field Detail
							</h2>
							
							
								<div class="fixedFont heading" id="FilterModel">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{Model}</span>
									
									<b>FilterModel</b>							
								</div>
								
								<div class="description">
									<p>JSON schema for filter values. A filter allows one to limit which registrations will be used for notification
delivery. The attribute names closely match those in <a href="../symbols/Registrar.html#RegistrationModel">Registrar#RegistrationModel</a>, though route
attributes appear with a 'route' prefix. Each attribute has as its value an array which contains one or values
that determine which registration values are acceptable for use in a delivery.</p>

<ul>
<li>registrationId: array of acceptable registrationId values</li>
<li>templateVersion: array of acceptable template version values</li>
<li>templateLanguage: array of acceptable template language values</li>
<li>service: array of acceptable notification deliver service values</li>
<li>routeName: array of acceptable route name values</li>
<li>routeToken: array of acceptable route token values</li>
</ul>

<p>All attributes are optional.</p>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="LogReceiptModel">
									<span class='lighter'>
									
									</span>
									
									
									
									<b>LogReceiptModel</b>							
								</div>
								
								<div class="description">
									<p>JSON schema for a logReceipt call.</p>

<ul>
<li>sequenceId: the sequence ID associated with the notification request</li>
<li>when: the timestamp when the notification arrived at a client</li>
</ul>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="PostModel">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{Model}</span>
									
									<b>PostModel</b>							
								</div>
								
								<div class="description">
									<p>JSON schema for a notification posting request. A notification goes to a specific user. The request may contain
a mapping of template placeholder names to runtime values. This mapping is used during notification payload
generation, where a template placeholder gets substituted with a value from the substitutions mapping. Finally,
there may be a filter definition (see <a href="../symbols/Notifier.html#FilterModel">Notifier#FilterModel</a>) that will restrict notification delivery to
a subset of the registrations for the user.</p>

<ul>
<li>userId: the user to notify</li>
<li>eventId: the event ID to notify about</li>
<li>substitutions: the optional mapping used to perform template placeholder substitution</li>
<li>filter: an optional filter definition to restrict registration use</li>
</ul>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="postTracker">
									<span class='lighter'>
									
									</span>
									
									
									
									<b>postTracker</b>							
								</div>
								
								<div class="description">
									<p>PostTracker instance that remembers notification requests by sequenceId value. Used by the logReceipt method to
calculate notification round-trip times.</p>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="registrationStore">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{<a href="../symbols/RegistrationStore.html">RegistrationStore</a>}</span>
									
									<b>registrationStore</b>							
								</div>
								
								<div class="description">
									<p>The backing store for registrations. Notifier asks it for registrations associated with a given user ID. Also,
if a notification sender object encounters a registration that is no longer active, it will be used to remove
the registration.</p>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="senders">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{Hash}</span>
									
									<b>senders</b>							
								</div>
								
								<div class="description">
									<p>Mapping of service tags ("wns", "apns", "gcm") to objects that can deliver a notification to a device.</p>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="sequenceId">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{Integer}</span>
									
									<b>sequenceId</b>							
								</div>
								
								<div class="description">
									<p>Sequence ID for tracking. This value is added to all substitution maps under the name "SEQUENCE_ID"</p>
									
									
									
								</div>
								
								
									
								
								<div class="hr"></div>
							
								<div class="fixedFont heading" id="templateStore">
									<span class='lighter'>
									
									</span>
									
									<span class="light">{<a href="../symbols/TemplateStore.html">TemplateStore</a>}</span>
									
									<b>templateStore</b>							
								</div>
								
								<div class="description">
									<p>The backing store for templates. Notifier asks it for templates associated with a given event ID.</p>
									
									
									
								</div>
								
								
									
								
								
							
						</div>
					</div>
				</section>
			
	<!--
	#### METHOD DETAILS
	-->		
			
				<section>
					<div class="details props">
						<div class="innerProps">
							<h2 class="sectionTitle">
								Method Detail
							</h2>
							
							<ul class="methodDetail" id="MethodDetail">
								
								
									<li 
										 class='item0'
									>
										<div class="fixedFont heading" id="postNotification">
											<span class='lighter'>
											
											</span>
											
											
											
											<b>postNotification</b>(req, res)
										</div>
										
										<div class="description">
											<p>Post a notification to a user.</p>
											
											
											
											
										</div>
										
										
										
										
											<dl class="detailList params">
												<dt class="heading">Parameters:</dt>
												
													<dt>
														<span class="light fixedFont">{Express.Request}</span> <b>req</b>
														
													</dt>
													<dd><p>Describes the incoming HTTP request. Message body must be JSON that follows the
<a href="../symbols/Notifier.html#PostModel">Notifier#PostModel</a> model.</p></dd>
												
													<dt>
														<span class="light fixedFont">{Express.Response}</span> <b>res</b>
														
													</dt>
													<dd><p>HTTP response generator for the request. Outputs JSON if no error.</p>

<ul>
<li>204 NO CONTENT: accepted request and queued notification delivery</li>
<li>400 BAD REQUEST: missing or invalid attribute(s)</li>
<li>500 INTERNAL SERVER ERROR: unable to obtain registrations and/or templates to work with</li>
</ul></dd>
												
											</dl>
										
										
										
										<div class="hr"></div>
									</li>
								
									<li 
										 class='item1'
									>
										<div class="fixedFont heading" id="route">
											<span class='lighter'>
											
											</span>
											
											
											
											<b>route</b>(app)
										</div>
										
										<div class="description">
											<p>Add Express routes for the Notifier API.</p>
											
											
											
											
										</div>
										
										
										
										
											<dl class="detailList params">
												<dt class="heading">Parameters:</dt>
												
													<dt>
														<span class="light fixedFont">{Express.App}</span> <b>app</b>
														
													</dt>
													<dd><p>the application to route HTTP requests.</p></dd>
												
											</dl>
										
										
										
										
									</li>
								
							</ul>
						</div>
					</div>
				</section>
			
			
	<!--
	#### EVENT DETAILS
	-->		
			
		</article>
	</div>
</div>

		<script type="text/javascript">
			wbos.CssTools.MediaQueryFallBack.LoadCss('../css/screen.css', '../css/handheld.css', 660)
			codeview.classFilter.Init()
		</script>
	</body>
</html>

